# Private Liquid Staking Protocol

> **Hack4Privacy Hackathon** - iExec x 50Partners

Confidential Liquid Staking Protocol built with iExec TEE (Trusted Execution Environment) for the Hack4Privacy hackathon.

## Problem

Traditional liquid staking protocols expose user positions publicly:
- **Whale tracking**: Large stakers are identified and targeted
- **Front-running**: Unstake requests are exploited by MEV bots
- **Privacy breach**: Portfolio composition is visible to everyone

## Solution

Private Liquid Staking uses iExec's Confidential Computing to:
- **Hide stake amounts**: Positions are encrypted, only commitments are on-chain
- **Confidential rewards**: Reward calculations happen inside TEE
- **Private unstaking**: Unstake requests processed without revealing amounts

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                    FRONTEND (React)                         │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│              SMART CONTRACTS (Arbitrum)                     │
│  - PrivateStaking.sol : stake/unstake with commitments      │
│  - PLSToken.sol : Private Liquid Staking Token (LST)        │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│                  iApp TEE (iExec)                           │
│  - Confidential reward computation                          │
│  - Stake verification without revealing amounts             │
│  - Proof generation for claims                              │
└─────────────────────────────────────────────────────────────┘
```

## Deployed Contracts

The protocol is deployed on **Arbitrum One** (mainnet):

- **PLSToken**: `0x39b067f91a3cd342d7055cf832983c1f4e6a9f77`
- **PrivateStaking**: `0x67ec0d5d810b3e2e402140f90cb8ce3a473baaae`
- **Staking Asset (WETH)**: `0x82aF49447D8a07e3bd95BD0d56f35241523fBab1`

Network: Arbitrum One (Chain ID: 42161)

## Project Structure

```
├── contracts/          # Solidity smart contracts (Arbitrum)
├── iapp/              # iExec iApp for confidential computing
├── frontend/          # React frontend
└── scripts/           # Deployment and utility scripts
```

## Quick Start

### Prerequisites
- Node.js >= 18
- Docker (for iApp testing)
- Foundry (for contracts)
- MetaMask or compatible Web3 wallet

### Installation

```bash
# Clone the repository
git clone https://github.com/Wayleyy/private-liquid-staking.git
cd private-liquid-staking

# Install iExec iApp CLI
npm i -g @iexec/iapp

# Install contract dependencies
cd contracts && forge install

# Install frontend dependencies
cd ../frontend && npm install
```

### Running the Frontend

```bash
cd frontend
npm run dev
```

The frontend will be available at `http://localhost:5173`

### Testing the iApp Locally

```bash
cd iapp
npm install
npm test
```

### How It Works

1. **Stake**: Users stake WETH through the frontend. The stake amount is committed on-chain using a hash, keeping the actual amount private.

2. **Confidential Computation**: The iApp running in iExec's TEE calculates rewards based on the encrypted stake data without revealing individual positions.

3. **Claim Rewards**: Users can claim their rewards using proofs generated by the TEE, verified on-chain without exposing stake amounts.

4. **Unstake**: Unstaking requests are processed confidentially, preventing front-running and whale tracking.

## Links

- [iExec Documentation](https://docs.iex.ec)
- [Hack4Privacy Hackathon](https://dorahacks.io/hackathon/iexec-50partners-hack4privacy)

## License

MIT
